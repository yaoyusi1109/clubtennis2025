---
title: "Financial Analysis"
format: 
    html:
        toc: true
        toc-depth: 2
        code-fold: true
author: Yusi
---

This section focuses on strengthening the club's financial health through data-driven strategies.

## A. Historical Review

- Objective: Analyze financial data from the last 2–3 years to understand revenue streams and spending habits.
- Data Sources: Dues, parent contributions, Giving Day revenue, and historical costs for travel, gear, and other expenses.
- Goal: Identify spending patterns, highlight inefficiencies, and establish a financial baseline.

```{r}
library(readxl); library(dplyr); library(ggplot2); library(scales); library(googlesheets4)

# TODO: swap back to read_sheet() when Sheet link is fixed
# Data = read_sheet(sheet_id)

Data = read_excel("data/TennisClubFinancialData.xlsx") %>%
  mutate(
    Date = as.Date(Date),
    YearMonth = format(Date, "%Y-%m")
  )

FinancialData = Data %>%
  mutate(
    Date = as.Date(Date),
    Year = format(Date, "%Y"),
    YearMonth = format(Date, "%Y-%m")
  )

ExpensesMonthly = FinancialData %>%
  filter(Flow == "Expense") %>%
  group_by(YearMonth, Category) %>%
  summarise(Spend = -sum(Amount, na.rm = TRUE), .groups="drop") %>%
  mutate(YearMonth = factor(YearMonth, levels = sort(unique(YearMonth))))

ColorPalette = c(
  "Travel"                 = "#F77F00",
  "Tournament Fees"        = "#00B4D8",
  "Facility Rentals"       = "#43AA8B",
  "Equipment & Supplies"   = "#577590",
  "Uniforms & Merchandise" = "#9D4EDD",
  "Miscellaneous/Admin"    = "#E5E5E5"
)
bg = "#861F41"; fg = "#FFFFFF"; grid = "#E0CFCF"

ggplot(ExpensesMonthly, aes(YearMonth, Spend, fill = Category)) +
  geom_col(width = 0.85) +
  labs(title = "Monthly Expense by Category",
       subtitle = "Aug 2024 – Present",
       x = "Month", y = "Spend (USD)", fill = "",
       caption = "Source: VT Club Tennis") +
  scale_y_continuous(labels = dollar_format(accuracy = 1),
                     expand = expansion(mult = c(0,.05))) +
  scale_fill_manual(values = ColorPalette) +
  theme_minimal(base_size = 13) +
  theme(
    plot.background  = element_rect(fill = bg, color = bg),
    panel.background = element_rect(fill = bg, color = bg),
    panel.grid.major = element_line(color = grid, linewidth = 0.25),
    panel.grid.minor = element_blank(),
    axis.text.x      = element_text(angle = 60, hjust = 1, color = fg),
    axis.text.y      = element_text(color = fg),
    axis.title.x     = element_text(color = fg, face = "bold"),
    axis.title.y     = element_text(color = fg, face = "bold"),
    plot.title       = element_text(hjust = 0.5, color = fg, face = "bold"),
    plot.subtitle    = element_text(hjust = 0.5, color = fg),
    plot.caption     = element_text(color = fg),
    legend.background= element_rect(fill = bg, color = bg),
    legend.key       = element_rect(fill = bg, color = bg),
    legend.text      = element_text(color = fg)
  )
```

## B. Fundraising Strategy

- **Objective:** Develop and execute a targeted fundraising plan to maximize revenue.
- **Key Initiatives:**
    - **Giving Day (Feb 19):**
        - Launch dedicated campaigns for parents and players.
        - Actively monitor hourly leaderboards to capture prize bonuses.
    - **Secondary Streams:**
        - Explore opportunities for selling merchandise.
        - Organize tennis clinics for the community.
        - Develop an alumni outreach and donation program.

## C. Budget Modeling

- **Objective:** Create a dynamic and user-friendly tool for annual budget management.
- **Implementation:**
    - **Tool:** Develop a flexible budget model using either Google Sheets or an R Shiny dashboard.
    - **Features:**
        - Provide scenarios for different season types (e.g., travel-heavy vs. local-heavy).
        - Automate recommendations for allocating funds to entry fees, travel, and equipment.
